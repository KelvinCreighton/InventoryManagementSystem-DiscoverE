<!DOCTYPE html>
<html>
<head>
  <base target="_top">
</head>
<body onload="initialize()">
<!-- Load the de logo (I could not find a better way to do this except to use the pngs base64 code) -->
<p>
  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZkAAACCCAYAAACUw7UiAAAAw3pUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjabVBbDgMhCPznFD2CPHThOLa7TXqDHr8obLK2nUQYeYwIHO/XE24DhAJSN23WWnGIiVF3oiXQp8Ui006YJcM1DkrZRB5i9xxXbeHxjGfD6bE7q1ehRybua8Ik9fVLKB/mMdHgewpZCjFFAlOgx7dKM92uX7gfZYXGgWFE17F/7ptvb6/+DhMdjFzcMmsMwOMIcHfS3CKLF3qR84HOdZZiLOTfnk7AB/82WSwJ5dKNAAABfmlDQ1BJQ0MgcHJvZmlsZQAAeJx9kTtIQmEYhp9z7I5dIIeIhjNYUy0V0VgWSGAgZqDW0LmkCZ6jnKO0NAatQkOXJauhpbnWhtYgCLpANDc0FbWEnPhVUCL7lv/h/b/34//eH+RSRjedlhkwrbwdCQaUWDyhtL/SRg999NGp6k5uNhwO0bS+7pHEeTcmZjXv+7O6jXVHB0kBZvScnQdpDZjazOcE7wM+fUM1QDoHRu1YPAHSo9C1Kr8JTlVYFjN9djQyB7IPUFINrDWwvmGbIE8CfsO0DJBjVTYEbwk2MwW99k6xoXfdWl4SOjBEkAUWCaOgUSBNhjxjpLFQcIgQJNDEP1jxhymgkSGNjsI8WUzUih/xB7+zdZIT49VJ3gC0vrjuxzC070K56Lrfx65bPgHPM1xZdX+2BNOf4CnWNf8R9G7DxXVd0/bgcgcGnnKqrVYkDyAnk/B+Bt1x6L+FrpVqbrV7Th8gugWhGzg4hJEU9K422bujMbd/e2r5/QA2WHKOoV3MAwAADkVpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDQuNC4wLUV4aXYyIj4KIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjI4RjU0QzNENTlBMTFFRTk2QzRCRTIxN0FFMzU1RkIiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ZWVjOThjODQtZmExYy00ODM4LTg1ZDktNmQzZjQxZTcwMWE1IgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZWZjYWFiOGYtOTM4NC00YjEyLWJlNjAtODgzNWJhMDRjZjViIgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iTGludXgiCiAgIEdJTVA6VGltZVN0YW1wPSIxNzE4MzgyODQwOTA2MTg4IgogICBHSU1QOlZlcnNpb249IjIuMTAuMzgiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIgogICB4bXA6TWV0YWRhdGFEYXRlPSIyMDI0OjA2OjE0VDEwOjMzOjU4LTA2OjAwIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyNDowNjoxNFQxMDozMzo1OC0wNjowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InNhdmVkIgogICAgICBzdEV2dDpjaGFuZ2VkPSIvIgogICAgICBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmU0MzFmMjI1LWZjMmQtNDYyMS05NTE2LWU2Mjk3YzFiYjNlYyIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iR2ltcCAyLjEwIChMaW51eCkiCiAgICAgIHN0RXZ0OndoZW49IjIwMjQtMDYtMTRUMTA6MzQ6MDAtMDY6MDAiLz4KICAgIDwvcmRmOlNlcT4KICAgPC94bXBNTTpIaXN0b3J5PgogICA8eG1wTU06RGVyaXZlZEZyb20KICAgIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MkU5RTU0N0EwMDNGMTFFQkEwRkJBQkRFRTE1MEM5QTUiCiAgICBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjJFOUU1NDc5MDAzRjExRUJBMEZCQUJERUUxNTBDOUE1Ii8+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz6q6JYbAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH6AYOECIA4shUjAAAIABJREFUeNrtnXe4FdXV/z/nnFu5lKFJUxQRAbsjdo0ae40VjMkYjSVRY+FVY4wt8U15NfZYfrFFGXvFEmNv2JURUbFQFBAB4cLQbztnfn/sdWTueMo+5Tbc3+c5j3LPnJm9Z/astdda37UWGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYZEUs3wF9j98ungyCHYF4Eef/xne92ZZjW8Bmoeu1xIm9v8SdnGp1LWe7eJLABqrlTwHwhe969QCWYw8HBhZw/Vm+683POjd1vW2AWs3zLa+IxT5JBkEigO1z3JPVQL3venOynajYuViOPRgYluH7ZmBRZSz+9aIJHwTlWBzy7LeTZ9cDWAV8Js8uGT62t2PXBrBNketkVgzqA9iuyN/PzXSvLcfuCewMbARUAIuAyb7rzTSvvoFB+6Ai3wGpIKgFXipAEIdxheXYFwI7AM8ACfm7nyIYIsL4eyQJqoFHgaHpywPHAg9bjh0HzgN+W8D1fwfclO3LJEEVcD+wqeb53mgJgr2B7sDLQE2ugy3H9oHbgH/4rrco9PdS5nIscHW2g5qD1HLLse8CrvJdb24xi8Jy7BhwXDIIrgQG/2BNECyU53q373op2Q1sCLwKVBVxyd8F8DjwSmiDUQguBy4Ljd+Sf/8u0xq3HPt14Gzf9aYYEWBg0LbQ3TWmijx/EPpvKsPf810rFTm2kB16SvP4oIj56N4TCzgf+NBy7M1LuG4qci9z/bYncBbwmeXYPxeFUYiCqQRuB+7JpGAEA4A7Addy7KoS10kqNKdS1xmWYw8D3gXOybGJ+gnwruXY4wq9PwYGBm2jZNICIJVDeEePySXki3XnBBrX1Ll+KefMd48yXXMI8G/LsWvaaC6ZvqsDXEBbkMpxvwdOiHzVAHwVtTyBnwOXimVWjnWSKuX3lmPXAQ9ksEwXA7Mj56sSRbm9EQMGBnScu2yp661C+eOju90vWBsbaAHG+q73eBbh1Vbjv8N3vVPKeL4k4Piud38eYRz9UyOwq+96k+X73sA1wPEhRb61CLRJZZ7La8BPUfGu3eS66QEmgOuBN4BvNM41TJRMWGlMAE7zXW+NKMmbRQnF5DMeuNd3vc+AbhliIvNDf291nzKge4Z1NhsYxNq40+G+6z2TRUGeBIyhdWzsFN/17pNjRgJPACPl+24ol+5+vus1G3FgYNBxlkwm5RTdHSdof6JC3HLsRCe6JwD4rrcUOFMEbPj7UW0wlzhQ4bte0ne914B9gC9D3/cHTs9nzcj3x0c2FF8AZ/iut0bm1QCcDnwSOqYbcFKW81cUs7HJc2y2e1QFnBxRkP9ExdzSz+UL4NdAU+h3uxhrxsCg8ymZjkLQhcbanMF6iLXBXFqdRxTcbaG/x4AjyR9QrwT2jozx4aiLTBTNvZHr7ltkwL+cGA6MCP27CXjQd73off4AmBKZ974mNmNgQMe4y9oIVcBBlmM3Zvh7twLOMxQ4xHLsVIZg8jtp6nOBqIzETsJozCC0sqEXsAmtXXFzipzLm77r+QXM4W1RcmnBvyHK5fRVHiUzOvTvFuDjLPOdIt9XhgR8d3GHdRQ2j6znVRGLLjyvKSjGY1oJby4WUosRCQYG64aS6S675FKxj3wyWRH7AK8XeL4E8G/5ZDrnyCyCOg6Mshy7RYRWP+CPQN/QMQtF+Bc6lyaEDVXAPOZHSApxVE7OV3meSW1EuS3Ocmx95PwJmWt9B67lfhHLvF4UOxFLLGU59qI8vzUwMOjiSoYu6FZryWMF3EVu19kFvusta6e5rMnwu8o8v+mWIU6UzDEfIm7A2g5+5jWR8SfzPI8fw3tgYPCjVTIp4LsMgjCGClQnNAP/9cDcDOdpAVaWeczFEgzmAGejWE3FzKUZ5fqhgKoNmRRGs4Zi0l0fFRkU4eoOXsuNMo6YxvOqKmADYWBg0AWVjA8MkyAyIYZTFYrRtJHmrn4iiqIalImxlgL+CryQRTHO17A4osL9TeCpDGNsi7mkMZjW7p8U8G2e3ywXRVMbcrGtR/ZkzHhESNd38FpeJPOMh1xgmbL9Exnm9V0JiaAGBgad1F0WL4O1EJPzJCmPay1dK21SEbvo3XzX+8By7J+jkiDTczkKuBZ4v43mEmSgIu9Ca/fYV6iYEHncgZ8Cu4fWxraWY7diaMn5t42snRl5rK32wCcyh4qQNbc5P4xlVbA2jyh9/z71Xc9YMwYGhsLcqZFWKo8BH9PaNfNHy7HbS6H3B34TsqgCVD24Rg3K9fMRpTVWSuMQIQgcFzn/C7TOPekIzAI+C/27Gjg+VI0gjZ2BLSLzfsEsXwMDE/jPhFpggOXY2Xb/K3zXa9dYge96jZZjXwXcHVI8B4lwm9QGc6mS34Eqp3Idras0LwRuzueG810vsBzbRWXw92Et9fk2y7HP9l1vnuXYA4CraE11XgncVSY3X6n3/VZUEdG0YjkVmGo59gSpWLAdqi5bVcSdOdmIAgMDY8lkws+BecCCLJ8TO2hcj9I6K74KuFDKpJR7LjuhyAVzgBcju/QG4He52h3wQ5LCXyLxpaOAbyzHDmQcv4xYMdcCn3eS9fBv4K3IJur/Aatl/B+gcnq+V9zAH0xJGQMDo2QoobpvR+yqG2THn4zkwezZjnNZLArhsQLGHQA3yEfnencD/5su99/R8F2vERhHa3dlNqxE1Tp734gBAwM6pbssHolH5CrLEctwfDHnjRc4vliB1GTd30R/l2k+j6CKTW7J2jyViyzHfg0VoC52LrnGGABfo3r3XCIlZgoV1EnLscejCm/+ldauMUKB/suBezTcZIkSaeAF/d53vW8tx94e+BvwK1onxIKKwUwSC+8zIwIMOgMsxx6Cqqu3PqpdR/p99lGVK+70XW/5j0nJNAC7hhhMAYpCmg2TUCVWYqFEuTWFnFcytS8GrkSfdVWvwQrbi7U++iBHlnuUgj0yUoxxftSasRx7j0jgPAU0S/yj2LnchnLHReugNQCLfNdLUrpFEKCaiD0unTh/gqL91gNv+K43uwCqes77pLHOxoTWaYCiG+tYNOdajn0eiglno5I1vwJe811vpRFrBp1IwcRRFUJOz+HJaEJVQGeda79sYGBgYFC0ArGAZbksfsuxq8VzsGOOU90JnJprEykx3xrf9VZgYjIGBgYG66xiSViOvZvl2C+I9X9dBio9kbSAzfOc1s7lebIcuxZ4ClhqOfZdlmNvYZSMgYGBwbqnXPZBMUsnocg+cZQbzMnRTmJ78rfiGEmWChyiwP4M7IeKW/4K+Nhy7Fctx7Yx7jIDAwODLq9gNgXuydEAbwWqmsY0YGOxTA5F9WLqR2G1EJ+Rz8fy76NRPZ4qssRzHwd+67veIqNkDAwMDLqegqlAlZI6Ns+h9WKxdKe8Nfu6a1RBv9h3vb9iMv4NDAwMuhySqITkIM/GvS9tU0YKjbqEX2JiMgYGBgZdD8Ice7cTt4xoAt4xSsbAwMCg6+J9Muf+dQZ8gUZ+mVEyBgYGBp0XdXR8T6VsWIJqfYEJ/BsYGBjQpYL+MRRL7B6gRyce6hzgcN/1PjRKxsDAwKDzZe07qLiGl866l06+f0LVKEx0gak0odpfTEhXIJBqA3sAQ4D7pCSTUTIGBgYG7aRguqNao++NYo99hEqunAbcChzTxeRoEvg7qm7iT4EbUUU5A1RbjLPK3SXWKJm2WZh1qEqq3VDFPmOoIneNqBLzfke3+5U6RxaKY1/F2tbPzTLG5W2xqymTe6KXuCZqUDT8QMa9Wsa9yqxCgzK9I7cBx2coSNsSaXFeMgIREqlgbZ+NOJCIlV1QZxt/ClWo88pyNiGMFXjTq1GVQKuLuNYaVNbrXFTZhbnAd77rLWmjBbIrqg1xPA9//FLf9eaUeK0ewChUL5OxwGC5t7EMDzd93TeBO1CF8ea1R2dJy7EHobKOT0FVVq7IsgbS630qqmfMf4GvOkoxSkfObeVlP0gUY7b7GwDfAA/J54tiCgaKK+RqoLfG4a8A/y5XXx1J7rsQVUokH74E/pZ+NiIY/wwM7YBHtQo403e9psh8DqR1y+5i0CLnXw7MlnnPAxb7rlffRpuZ/wGuaCtXWDKAZBy27Zlkqz4pBvVrpH/vBvr2aKKuOklLKsbSVZUsXFrDosU1fLo4wQdLE6xuiVEZa1OX2s9813uWDkrGrBBBWlcuxW059nR5mf9TQAdHHWwkCzuRp9T/taigWDELcShwriizKo2XKBbqlLmXfFKAJz1c3im3IJeXZXO5x3trvjDp/j+2fK6T7pi/B55sj5bWsqHZSUz7HQoYN6i20ecD5wHNlmPfI8JiegHKPCnK7Bcax9rAfWWksPZF+fm7a7xDf440x4uLIt6ajmExjRdBFcYouY/lFo1pGTJP3uPHgLll2rDthOqnlCh3J8W6ioADhrSw++Y+B265lJ41LRAL8t6cIIDGlgQvf27xnNeHZ+ZWsrIlVu6bWgX823LsMb7rzaOLU5hj8gBHiUk6x3LsiZZjb9IVAoGWY/8TmAmcJZZdrIRnMAZ4HZhkOfbwMo6zP/AAyo+8XwkvTAzYALgfmG459k/zVJUtaRcvO98vxULYucRxV6GaQX0GvGw59ig0m7ehaj7pKP2Ngc3KeBv2IX+ZkPQm6fH2sILpvK1KEmK1XQvMAp6zHHtEiWuwFhVvqaaMymWTuhSX7rYc79zp3Hjilxy7w3f0qm0mpqFgAGIxqKlMctCW9Vz3q+m8O346v99xBYNrUuVuATwQuFYs6nUqT6YC+BnwmeXYNwujozMqGBv4FPhdmcvyxGT39Inl2L/IUbFVd5y7i2AdW+bnPBh4XhZhbZnv7TBRtv8RwRErc07YnqjqtNdZjt1T4zcvo5fEViVKvCyVfAvYEHyISrQz4PvOqfsC0yzH/ovl2DUlnKdXuQa1XnXA5Xss44XxX3L6PnOVYimDsOhT18z4A+fw0tkzONNeRW2irKqmV7nev3gn7dZ5mgjbMZ1MwewjJbwHt+FlaoC7UJ0d48W4xyzH/jnwYhvVSkq/hGcCDwr7puTOgJZjO8LY2bmNCSkVwNnAFI2eG6uBJzTf+f0kjlMqasWS0XEVPd7JyBmxTiRDLgIek3gpBZaJWYmK/5VMIPnZRk08c9osTt3rG6orkm0y2V61zVx42Nf85+S57N6/LN72+agGac3resb/EOANy7HHlbqrL5OC2Up8vt3a6SX5G3BcIXOXY48UJVXVDgLlUOBOiZ+UEnu5WsZcUyAV82O5T1cB00PECh0MA96zHPvwbPdYAvmPo5hr+bBDtn4fFB4L6K9JpJnYyd7Zzua2OxC4t0iL5jVUTK8oqV0Th8v3XMY/j5/BYKuhXbT7qEErmPCbGZyx7SoqYiWRN35RQIv1Ll9WphqYAPyyIxWNUJLvpH0zeitRHPZCYjRbtZOCCeMo4A/FPB95+W8Xy6KQtbgS5QbcHuU7vwHYApW/0FCg1fAQcGKO8b+BYqvprNV9y0DS2F+TGvs2imVlkBsHAxcUuj4lznUbKpO/MMuiIuDWIxZz0h7fUBFvX71bXZHkwkNnc+0BS+lWuPsshSKSvEoXqF2Wkh1A9EORbIdbUYlDHYUTURRaXSyWndAlwnA7GhXDeQhF3U4W4Bf9u04ATtxWd1JYr4qlYgG8JDv2F1AlyxcWMMY48AdguyJyEG4sgnXUIL95E+W6nAV8BTyJIjmcWeBaqwRuyWE1Nsq9QSceUGKwtBq92E5KXGVNZciVKPeHEmnKuT7JImXc+ShyRqHoBuxSyA96VgTcetQi9t5yIbEO2hbH4wFH7vAtt/ysnu6FKZo4KsWhrC1g2qqfzNXApVmutwUqS/YIFGOpQjNO4Qqt7tt2tmJqUKUYdBTyMjGxJ2QRADdJYHc7FOVVx0o5VBTc+3l2wGcC22hOa7YoveeB5jA7Sc6VQLkrr0fRYSs1ns+fLMc+QsePK9e4UJR3rEDBeKMo8JdR1OE09kex345B5QA5BW5kbgO+FuXVymVmOfZEuV/5LMS9xTpaUeRyGwFsqnGcbqwoFybKPSpnoCAoIUa0BsXQW0B+N/rRwEny/sQ1i1eeZTn2eN1cJlmjJwObFOIiu+7gpew2alGHB6diMdh7y4Vc3RTnrGf60KifwbU/KrXi+c6uZJJAYxZq5TvAO5Zjny8KZ4K4efI9l0EoRtMv2jkpcEvNF38psJfveh9pUGPfsxx7G3mQO2vsbo+zHHtyjhekPypfJ64hpO8HTvJdryGHm6AFmG059hEov/aDGhbSPqh4wiSNe3UAKrM4XkRA8gr5bSbLcj9UoullKKZiTwpznd0nG5lFGcq4z9CgKfcGdkMlrxaD/TVps6+ItVmOd7Qz9UBpzLYuQ5gJXGE59lXA4WK96zzno1FkgJWaY+kBnKO7RuPA2TuuYN+tF5RkwQQBNCXjpFJKUVRWpEgUeb54DA6yF/BVfSVXvt2DlP6G6zzLsV8t0VLu+JiM73op3/Wmovzq14kLIB+OkBexPbG9xk4+BVyWT8FkYLA4qAzmfNg32y5adlynAX00d68narzI3ysc3/WeAc7QcIVUA78SSy3XDrGPuKeqi3Dv3CIC5fQsm5K0626FtMP9wZRQibfZWENDgWsyuLx0XWaVwjKLFVnCZD+NzVZSXGXN8KNuFJb0Xe9RVMtjnfXcr0CX97FiNWlhz0HNnLrXtySKiMGsbKhkyhyLCx4fyr5Xj2b3K0ex6z9Gsds/RrH3P0Zz+n0b8c7M3qxsKLyKTSIecOpPv2XvwQUtl5+I3Fs32i/7rtcsVk2AyhaO5XmJL7Ic+yVdQVmGQOyGGsq4AXi4iEt8DTyCShYkT7JfX1QZDTL4jU/QEE6LgDOK3J08IAoxH7X2EBnPimxUZVScaqimfz4WyhdZJYrjtDxWVT/glygCxMkhZfaKWDerUMlmk7L46ceKtfdMWNmKy+w8DeW4rxzTUESW/y6apIenMEjjeeBecZ/lk3V2Jktb1mVVaMNYLe+UVhJw38qA3x/4HbVVLQXtmBYvr+XaFwfw1GfdWNIcy0zNa4rx5Zd1TPyyjr4VAUdvuYqz9l5I7+76y6umsoXzDlzIhxOGsLg5phsb/LXl2J5sauLyHjR0WXaZuJAuQjFm8mGM+AxpJ96/TiC9HhWPKWber2v4xROoMjkZN1EaO64A+Cf5/d3ZxtmEqmGWb5x9xGWWDZui4luZVnqzuKV+icpD6iVWyxAULfs8uc8Ha6zpQ1CJqBeIddAX2N93vRViQX8L/CMLNbkKuCxDounHqJp7+bAJqopFodhXk8L9rFhkBmvfoQkZStlkWhdDo1amWN53oEriLJF7uzDPOm4lIE7dbhWbr6//+je2JLj7tfX5yQ3DuGtqHfXZFExUyLTE+NeH3dn9+o158J1BNLXoi+/Nhizn5O1WFRIrOkHeN1/uS73l2EWxSOOdaLE0oHztjRouiePLVfJAQzg3abLAqkpoJrRcdqjZPqsyKTvZgekE5lcDbonlR17Q2J1XkIVlJmMdnyXPaLm4QfcAPFTw/m/A5SjiwwxRcqtQ+Sj7y4ZkdWSH/xIqJnKwfHe7vCQ/54fFJm9DMf9WZ6lFdnBkfaZdZkG5s/8LyPJvEVdZZ+0l31HwsjzHH9zqDDJvPVlvtZGPljDdqDbgyB2/03aTLV9TzekThnHRK71Y1lJcsGVJc4xzn+3DOfcNY2VDlbbb7IgdFjG0JihEN4TvRzdJUK3u6nkyb2sGjg8sZ9mHPFz5BRqCpU5cMRSZ9DUYFbzP9hksQj6TQNtT4xrvAaWy8nwU3Tnfxm6LLHGZASLsyRBj+B8594eokj3Xo3JnzkX1uHgPxSS6UP79nbjuBooF/Ds5/8/kfPeIq2xHVJ7LjcA/LcfuIxURNhQX4MvAXzLEAyuAUyROQiSm1dAG2f+6Wf6+WDIGP1S+CzTdQJk8AUUnE584ZiWDNJMtl62u4pS7N+S/c6pLzlpNARNn1XDq3RuxYo3eUhtirWHs1iUVMRimSYLqXDGZqFvGcuyHUTkx8TxCfU/g0XYY1kcavSMSwNWWY7/ru94XhRIgivDfEypkN0zjuDc1s9bJE3D+UqP8/EC5H1HX2jFZqnevFAvh2hzn/g6VX7SH7Ph/Ke6wQ4G/S8xkaznPRiLoV8u/G0PKeJ7ch2r52yxUDtalGVxVu6MoxdNCf5sOTBZriTxZ+/0KUOy7aJYAeqoAdtSPDYFmjlXUut65WDk4qCpgzy2XEI8FWi6yPz2xPpMWlLUFDa/Or+TixzbgynFf5y1bE48H7L2Fz+2T61hanBVVJWt1alfP+H9Rw2VWAezaTlUA3kTRk9Fgr7xvOfbRGXbAbYXNNV6QFmBqqZV6xUXjyDxzfQ7J0E+kEjgsy3pbLAppgxyC4iNRHFvJszgVFZtLAM9ajv0gyn+8uVg7K1Cl7ptoXUCyBkVNrQrFTxZniTXVSGwnGpuaqCHQajQtk0Ky/JvFVZbEINMmr79m7DSl497Vwa4bNrBR39VatORnvYE88mVtm0z+sRk1PDN5IIHGGz568Eo279tSChvZ7nv8dvEua8kIvkWxrkbnOW5reTGbaPtGTPeISwcNbv1DwBeWY/8GeLeNCxiO0HiGSVRGfFkszSLvtyWuK7LEixpRsaWjUbGSqFUxXXb6T6EIAHUoBtghofkfjmIZnYcK5N4kwudLUUhkiYf1y6L8YsBelmNfG6ELT0TFirrlEXr7WY59r4ZS0C1H8x3KvWdAxnJKPTU8TF9FNlvVqFy9onJQDt9yDRWJ/JkX3yztxhUv9yJZ5gozfSsDNu+VYoeRKxgzYolWfk5FPMmRW67hjYVF74O3TAVBpYYh0KmVTIsIhtEaAjZBO+TzWI59DfArTZdGDMUuegVYKr+9A6gvZ8BWdsBDNAKUqSzUZ9o516g6Sxe+M9PUSMux7xNX1G8i4/9aFOU5qP49l/LDfitVqAoCx8hxx8vu/2uydwB8GpUTUJVn3M0RxfSmhmJIZ//nc2+NkrWMRo7TGsq7+6+xHLulA7P8y9Ua4QQN4k0ziiBAJMZQVDxmQGXA0IH5U9xSQYynJ/fn64bSnS7dEgEjuwdsPXQNR41ZwhaDV1NZkdRy14UrAWwyZCU9Ej1YkSxqTJsWKnc7o7sshfK/6+QV9GinWNE8VBC6ucB72xfVXe8bYK7l2Bdbjj24TMy4uKbSa0Yv4bMtsUWWDU0qXHxS4lPfRvzsz6NyXjYCPkCxznL5HbqLNfSK3J8b5HfRN3ESilBwQo6Xpnu0rIhYNRM1kod181721RB0aVdZqozP5FBUBYVFJX7eLqFvSzlwgGwA8xoUKBp6GHNRFQQKvq+DuyfZsE/+UKq/uooHPyyucHsiBpt0S3H4sEb+deQCPvr9dJ44+3P+dtTXbLfhcqorWwpSMGmMHLSSwdVFGwBvxYi1dGklIy/S4jIK2XLhHlRJ+VSRSa8Dgf9F1Q372nLs06XDZqyEHJ4emu6+FB2304zLjjGWJZB4XJqNJsLqyNCC/qu4wVajqj2PipynWdZKfaQiQYy1VOd6sVbuCN2HlaiiiQfmUQQJMidsPqFBmc2b/S+xqv01rNHZwFuUv51E9zJ8ajtoXVVajn0cKgm6WoMU8BCRwL/vektR9f72RhFJtONdmw1sIh7P/1p9OtviqzVx7Rd6YHXAXgNa+PPe9UweP5OXzv2Cm341g0O3qqeuurksVZ1rK5MMX68g47NZNmVbA4cvcSc3dfWYDOLvC/K8fLF26u3yfdKX5diXykL8Qwn3rkLcXDeJ0nrCcuz/ARYUGJyPaZr6Hd3UKi4KNtt3lwEHW479Iqou2VNikp+Johlfh6pPFe3U5wvTzJO/703rfj8xlJ9+XxTb6yxxuV2CIgfME2VRUcTYF6LiI4eVmP3fXzPp7/ESGIh0oUZlvSzHXpPneaTTBc4H1tfcKC8Fbsz0foll+qrl2FuKVfS4TquF0eslieWxIlJBjClza2gOcldtHtk9YMwmKxk3Zikb9l0jLrC2LJ4ZMLxvMrsj+Yeb1K0lnpXqkmVlShSMFe1sZbVYjn0Ziu10R4EFGLPlRxyLqsn2sOXYZ8nuqqt1IsynZHrmsRZ2FMtjACo/5h5x5TyFopj+K/KsAxR1+f3QzvZ5OW58RAmnNwWbonJnHhXXyb0oRlu++9szyzp4XBI2E3n815uSnfKpk+XfCEwslR1I529UVivvVb7nUVHguk/KRma+xiZyle58hvZK5VUEqVSMKfNbi6jqOAyrTbHVkEaO2n4JYzZcRVVFS1E1z4pBczLO8jVV1K+KFyJjlpfiqq3AoBh33iOWY7+GKmexTxnuYzUq9+Mwy7FPBx5Yx6iqFZqL2REl8AKqDM6eImSbIlZbi7g3iNQX+0xcYvGQAmsJ1SSbhkq+PF6jPE16TNkCyk+L262XRn+YqSVk+X+RIWC9rqKqDRSgC/xLU0nX6SiweAwSWq2UYyxaUcEGNQGj+7RwwLZLOXDz5XSrbqYy0T4e7FQATc0VTJvfjXvf6Ys3p4av1sRpShW0ka1Dxd+MkmlnZbPIcuyDhQV3O4pvX2p+TE9U+ZT9LMf+TXsUAW2nnW6z5nHXoXy/u6OoyBYqJlMVsW4rgO0sx346LTwk9rNdxH2SlN+m5NxXoerePYyK0+TrZ5OrrFA6+36cRvb/9RmqJutk+QdCMmg0b1xRBKIHgNMKqFhd1hh1Ip7kjhNm07O2mapEst2amDUn4yxfXcVjUyxemNqLz/2EbmHMNvGYVHTitsu6AamOtmo+tRx7N1Sc5f/ET9+thAeTkB19f8uxj/Zdb3WJwjtBxyuZZZpJr39FFa48GZWLcpKUmUlEhH0M5ZP/QGI5MVTJmhMj100r6bNQLrh/oOjRf0WxBXfOQ5UPshWjFJfZRBQhoUIjmz9a9mToHDkvAAAclElEQVQ3VP8Z8rjKHuvErrLOigZU7O36AlsitOj2fEml4lp04f49GtrBWonR1Jxg6rw6HninDx9+U8OsNXGaU2XtD7bOKRmdAnUB2fuCdEQl2DkoplR3cfP8L4oNVVPkzuEA4GbLsU/J8aI0aPY46egd5Xzyd0UcL3M+Wcb8Z1S9sjNknj+JkEG6oQL3K0JMu1gGBfGCmPuPsZbJ9XtUH/PxqLbNVUWO/b9yjX7kz/6/J5LjtJ/Gs/kI1Q67LTAD1c6gVAW2sAxtlyljjt1bKErz7CKUs1ZMJgCWrooTBHRYi+XmZBx/dRWPer155eNeTFsWp7451labxFXrlJIRt8cATeG1pBO60VYCT1uO/Yy4v/YH/oSiwlYVqGh+gSqg+e8sD3+Npp+5Q5vTWY49Mw9b8CFUVv8DIcEbR+WwbIOiGk8QK/EnofnEyRwTSYqb6SlRVM/SusZbLYrJtg+qcvOBOYTWTHL3dnlaxpkv+//+UJytWqNSc4DKjWkrV9kU4Nx1rKLzg9KUr7nINutb6L4r05ckSAUxErGgnWIrMZpaEnhzuvPwu32YMq+amavjtATtQtzZxnLs14ttlBfvpHWINtQ4bnFnLhYofUt83/UeRNXUWl/cNMsL3ARcbjl2zyxKdqHmOXp08O34OMdut0kUyNFk7pmztZTkXyqWzrF5+qkskOPSZfxPylJEdFuxON0cY1tGjpI8ojQe19jJ7xOxaEeTv3d8g2Y3TgNadc4dTWHKpZvl2OeiKO036m68py2sIAhibW6tLFxew82vDua4mzZlzJWbcrQ7hAe/rOWLVcUpmEQMqgqT+jWohOiZUpexel1QMhWaC2V6JzLTdRTOIt/1LkaV7T+jAAU5WCyabG0IUhrPeHAH34LJOZIXV6LYUwdkiR+lu5NuKEL3Tfn/qyLuwlWo/JcRkrz4vFiSG5HdjXiAuFey7dDeJX/Q/WUNZd8PFf9JY38Nq/YddDMZ1g0kUe67x7J8Jmu4sroBf9CtqGE59hBUJe6rUA33tLXGnMVVrG6qKLu10thcwevTLc65dzj7XTOSMdcO5y+v9ub1xRUsKcIdFo/BgKqAXfq3cPk+9bx39lecss2qYvTEBuJxeLN3gYqmM8ZkRpA9eS9q7rd0QVbaKlSs5TF5qbbVeMBHWI59ewZzdUa4PWqerHWvTHWi4hq1rFoyKJJJRKoahyzSFDCI3PkmS4AtZXNxE8oFeQUqB2KZCIoA1YvmF6gulqk8/S8GilWUymIpvqThTlqNiuucRv7s/5fS/59HoKXEVdbEjwdNwMm+683Psvb6okggAzSsmR00KyT0pMi+VPObYMbCbtgbNZUU7GhJxlm8sppHPujNm5/15ONlcZaWEFuJAVZFwLDuKfbafDnH2Mvo36NRStBASyrOghXxUk4/pFDjpDMqmYM0dnktwJttybqR4KxO0L6lGF+l73oLLMc+TJRlvvI4O8guLcrS+kyj100Fyl33SKllPFCVj/fIc+hrlmP/PHxPfNdrthz7SVTsI2qtDJLn/QmwK9mr7KY3FoegAvb7A0f4rnemjG9rFDV5Y7nGh6jYy4gc7/hUuX4ii7vqKc2Y0+MhwgI5Ei8vQWX576DhKptovF+tsEQ2EH/No6BrgAstxz5S472cIxZwweSc5ckYM7/twbYb+gUF/1NBjOaWBG/O7MGTH/RhyvwqZqyOkypRkg2pTXHwZis5dswyNuizhprKLAmeQYy5fkli/0uIJbuskpHg27EaZutKCYi3Jbqh/PH5StdcbTn2n4pUePNQxR/PJb9fdJgI2VYbKlSRv3zd6nayHLuy2MBdyCLaIg+TKr2zz2QZPAb8PYNCrUMlR/4R5SbdJcO67C3zf0osovtQyWH9Lcd2ZT1cJpbOQBS76DOxEiuyUN+fAq4BLiYzZf55zUKtiAtvDopkQJ5qy9trCLVX0Ov0yI8oLy2wHPsWlKt5SJ7D90M1PnyO/CkQU1G5UwXj0Y9rOXzHBJWJ/DJ3yaoK3LfX4+3PezJVrJVyRXTqEgHXHb6IXUfmL/m4eGUl3y0vSexPrYh17QKZh8uuOx/+o5l7QYnU25QIwVyf9Yu9j6KY3tNw+8WzNGVq1mxXvVsZiokOBIZqeACmZ6lWsBSVaJppbn8RC2U/uZ+7i6JwROmMAKb5rncrKvH1WMnen4WqlPBbUQhTxGK41ne9h1E05REiRE6Qc+4m1zhOrI9zMmxqmlFZ4rov0xpxmZEn9+tAjSz/pOTGNGNABiLGtRpxyCrgjxpB6mZUhe6i8PGiCqbN6651bPeaFEuXVzNpcQK/jAomDlyw60p2GlGvdfyM+T2YX7w7Lgl8sGjCB6kuqWQsx+6DKuNeoeG7ndAOZVdSsjtFo3laRYkvTlBMgqrcg+c1lFQ3VLJiKdhPI0m2JYO1FU5cvT4Lu64WRdP+UoR+ejf/hijy3wJXSA7SK6ikyo0j7qkqsRZuk7I/3eV6Y1HB+5dQQfo4Kk9mFnB1FtfsJLlOIZuFx/I0dIuhCjseQP5cjaeNPsl6n28n1B6C3Emwh2ic761iY7tLW2K8+LFFMpVfaFclUlxwyFyOGN5QVgVzwharcXafp1X7rCUV46mPetCYKilu9laXZJfJjuNOzX7177SDq+z7tsXo9UrZqoTr6ATSghxstGc1WiPEgfGWY1sluDFP0RjnanEdZcNc2YkGWcY4FFXMcpIo+K9QyZQXo1ouD5HYUpBnt/UIKr/mBBQh4C259lzgdZR7cnAWt2wDcFkR+SmThZSQT/DlewbPdcb8r06kaJah3JwpjVDARRq9bl4vJdnwwal1zKnXKwZfW9XCVcd+zW+3WUVFiZqmMga/33kFlxw+m+pKvf3259/25JkZJbX+maa58e5cSsZy7DpUwPYw9DTpX9ujE59YCa9olFSoBi6zHLuqyGD6oRqlX1I5dm8rCGWT58D6wFWFNkwTAsSZgK1x+Au58oBk53g1KshPEVUgTkRVv/azKOIPUSVk7kflx1QVQfi5rcjeLQ2oCgSUUAOqBcUqW5cSJNsCd6JH794K5VrN+aoLS3G+fGaIlau13/+mMcYj7/bXsmYAaiqT/PGw2UwYu5ANa1NF0buGd0tx/3ELOGPfuVRX6J2jJRnnjtf7FVIVoBGViDwTRdGfC1wRK6L9erwDlUul5diHoqrMHqrJUX+wnfucP6O5qzwIuLYQRSPC+5f5THrWlu74NofgvlGUTb71eSJwg25ClVCWT0OVyIlr+LfvzicgfddbIVbRmiLer1Pkv//IIASeAnbxXe9msagWFVEy5VPg4mLKmodcZqVsgHxUqRqD/GtIp4FgAhWbqcuTw/Z33/UGy2cEyu36ou547prSjalzrAIKZwbsOXoxL54znasPqGej2hSJPNKvKgajeiS55WeLeP6c6ewyor6g9gBvfdGfJwqzYm4GRviut4nvegN91xvqu97DS4sgOLUVu6xC+oeToSXtjrK72B1Yr4AEqNnAee28y/NlZ3uhRgO104G9LMc+BXgvW+BWlEsdcKXstnWewct5hNccVO7IBXnGGRelsb/l2Oeg4jnNYaEqZX0q5DldJ24nnc3I+wW8mO+Jy+qGAtdgH1R+zP9IMH/fkIvsiXTVaqEVP4nqTVNVwLMe57teKa2qP5HPdkX+/j8amwXKWFmj1nLsljLXuWpsp4Kerlito/IcN1zesxsKUGLNlmPfgWKoVejEZv7vmfW449cr6V6jz9eoq27h5zst4Mgxi6hfUcN/Pu3Bq9PrWFBfRSoZo6Y6xfBBazhw9Ep2HraaHt0aqEwUfmvnL6vh8v/2oUF/67QGuLNcz7GtlMy5IgjKZTWtAo71Xe+7DqBNXo1K7tMpdTMaFU+otxx7Dip+NEMERx9Z8LujYg916Afb3FxEBxnn/6ES0UZqnHNjFBtqObDUcuzVsrDqxC1lUVhDtkbgj7qtCWS8t8p9+H2Ba+MEua/HoMgCh4hwq84gXBIFuLqO9l1vGqUnFD6Oci3GiogBPtaOfYQOz1OepxislvdkSXvUCLQc+ypUo7pEno3V+ZZj3y3xHF08jaLBb6lz8BvfVXDts0O48NA5VBTYK6a6Isng3qs4ZbdVnLJbee9TU0uCvz85hGmFJWA+TRkLs8bbsCVrPPKhhLLd43zXe6eDTPMlqPLwjQXMvZ8ImtNRQcrbUH7fU0UR1VHY7vYNzYDoiQW6oXqKUBgt4x0pgr9ngbvXazSp1NGY1yWoGE2qwI3RjTLXY1FkgEHAnZZjb205do3l2HuJOyWhuWs7qhxuWNn5PV6ky2whBTDa2ugdLcenPfFAtHkd2ck1vxMvgu6zXC1rM6n7Etz+UR33vzWYVNA5GtYmUzFueXEIj82sKVTeXllOj1FnrF1GJKh9MCo20pF4Xqyz9g7ILgTGF5Az8Q6K7tueORaPApcXGcdoQbkiLyhwzDWi2GYJpfU+lDt1CooS/rJG0iiy497bd71nyujimUFxuRdPdpbWFXStEk1XaSiCGIoav16Bl3gI5QbWQnMAl73Si0ffHdThiiaZiuFOGsI17/YgVbji/pAyl3HurPgY2MZ3vZc7ummTXP9mVOC5qR0V7BG+680ucJwuig3W3A7NyB4BTiilg6dYNFej8keWFFFH6TBUiZkBBbTwTSfBbu273ttlXitpl1kh73azsMpSGBSKh0VW5ENfofHHC0w+rC9kMA0pOP+53vzrpfVpSXWMomlJxbjlpfW57NVeNAcFv9OLytBjqNMrmUZU690dfdeb1ZkSwXzXuwuV6/B1G19uNrBzMQJQFM2tKMbeijbMIboc+IXsJstxb19GueseKLUTn8b6Ogf4ie9637TRNQp1mc0md36RQW631pUaXoaYWPlD0e9rdQmKOVoQmgL4yxs9Of/+jfFXt2/PwBUNlfzhwWH8/c2ehSqY9D06m/y07y6pZNINuP4GbOC73tW+663ppIt6MioBczzZy9eXIryvB7byXe/TEoX2cyK0nylwV53vOX2KKvD453JXCfZdbzGq3MsYsTTKubNvRsXGNvJd74Y2zrX6Bo04WghPFEHpNliLiehVGe+FIgHoyL1jUaSUWLEvyoPTazj6lk1448u+be4+CwJ4b1Zvxt0ynPu+qC3FFKmSKvFjurqSCUSANKB8+j8FBviud5Hveou6gi/Yd73rxF3joCjEqRLuRQMqE36Y73rnlEijDY9zvlg0NqqsSrEWQhJ4G1WBeVvf9T5sKxemKMgp0n9lcxSDrLFIEz4l7o7zgKG+653qu96CdlgfzQW4zJrEVRZgUOz9XqNpzYAqxjo6jxVjoSjPVaWObdqKOOPuH8j4e4YzZ0ktQRsI0rlLajn//uEc5Q5myrJEOU7bS/LpqugACnMTquxHZZEv/HIRyAtQBRMXt2HPjMmoYH08j/D8toTF7QP3WI59vyicMcA4YO9Q+ZBYpjYSqP7tj6PYY7PK4XbKUTPsI2Afy7EHyBgdVByjR5bxpX2zz4r7amp7COcM4/4c+LXl2GehaNeHoJhgW8pzjWWxiN+QcU8C5nZQscmH5D1JaFQUf6/M1vBVZC6oSjuUYspk3b+GSmmI5fltKZurJ1HusJ4acjmhwTj8RKOthbaV8fDMap68aRjHbNLIyT9dyIj1VhEroXVzKojx8TfdmfD6AB6bVUVjMtYW7blbykVjNKBNKhp0QxWmrJb7nFYua4BV7ZgPkWuM3WWMVSGl2yTja+jE9zbdUromJDCaRcCtNFaBQRnW2AhR/hZtoIn36N/CXiNXcdC2ixnap5EYQc6+NEEAyVSc92Z357WpfXn1q2omL0tQ1TbTnwbsKptoo2QMDAwM2kjRjEOxNSvbqsz7mgA26ZZiSyvFRr1S9OjRRE1tC/FYQGNTgjWrK1m8vIIvl8X4aFmClS0xqmNtKrhXAruLy5rOnPFvYGBgwDpAj94C1VAvHnGzz0P1vY+VEhCvi8H8NXHmr4nDfAjENgnkxNGT15RHuyRR5JQNIvNqRiWMf8SPJE/GwMDAgA4kFKRQxWHvEbmfRDXeGw5sgqrikSp3GYZYloAj5WNZnoSKcW6LqjKRnttlwAPldjcbd5mBgYEBefspbQfM8V1vbqTY7fGovLSqLjCVJcDhvutNisxhUxRhYnJbJAQbJWNgYGBQmhLaGtXmYeNOPMw3UEWG57X3hY2SMTAwMChP+/i3xSrobPgPcExHJbibmIyBgYFB6ahB5cp1RgwHOozWb5SMgYGBQenYgR/2NOos2AjFJDNKxsDAwICu5yqLATvReVNCKmV8RskYGBgYdEHE0XOVfYIq5BmUMZ/zRWC+xvgGGyVjYGBgQJfMp0mi6iT+O0fezHzgYN/1tkPVldsJVVb/P+j3UZoHPAj8GpXj0st3vX2Bsagiu2TJi7kMuKmj7o9hlxkYGBhQNtfZKOAvwJEh+dokCubFLL/ZBZUUWZWn3MtQ3/WWZnHXnYnqFpsIlUj7J3B1R9CWjSVjYGBg0DZWzee+6x2Nqgjwd1TjwPNRrTay4VPy96bKekyoc+/twHdiIQ3xXe9/OlrBFGzJiMbcIEup7EAq4C7Oc46+ZC7Hne6rslh6vxcyripUx8rRcp6PgXcKrXRsOfY2KJZID1QfkvezNQ+Te9EfqMvRhG1xEWOoAQaGns0aYGG2Ug+WY1ei/K3xyPWXZOtLI2Mfwg8L/63sCv18DAzWMeunCnie3K0FbgbO7IotugtlQ9QCU1FNbbLdsGZgOqrGzzVhhSEd6f6C6vuQ66bXowJkF/mu936O4wYCNwIHokrWh7HCcuxHgPG+6y3LcY4EqgDeGaztEx/+/jvgTuDSSF+SBHCLmMW55vId8C7wB9/1pmko8fNQ9ZIIlYIYkcNvO1yeSVRh/Nty7FOyKLlNRBFHKZf3W47tdIY2BAYGPyI0Ax/kUDJJ2fCm6KKsCIqo4EkeutxmqOJx74siIMKIyIe+wL7Am5Zjn5epXarl2LujqoUelUHBINbIicAUy7FH5+in8jyqX/2ALGNZTxq1PS89Ygqdy3qo7pQfWI59kigScrQ+PYYfdqk7tIhncoBsCjLhoCzly1PmfTcwoL1dbIFsLA8FTpbW7unPibKJvq+rzq+ted3bAA9Yjr1fkR0wK8XymYwKjKWVw4YolsV66CUiPW459s7hoJlYMNcDe/FDV9cSoA+t3Yl7ABdbjn1xkTuKWuA6mcuUHAldoyJ/SwBjLce+r8AOj/2A3YH/ZnCvHWTicQYGnUrRLAOeZh3ld5dq5v0CGCqfUSjfYVgI7wocnOMc6dbFA+Uc41BMijSqgRNEKaSVw6XAoNAxC4GfilKqAY4Gwu2MNwXOj1hEO8nYY6Fd/A1AT9/1+knc6OrQXGLAKblchSg2xyCZy4ayKwkr1+7ALzNZMzK2sVkYJnvI+QpV0AdnsAIHouJXBgYGBl2CXbbId7258vkC1cv7vYi1tG8mlxetA9sLpYz2wyLsw4Hu0SGra5AoEUJUvfG+673iu16L73qNqIqof4ooiBNRLrS0QD8+EpPwUHGTlbKzWCnnmEVr11WuzNlVobnMQfHm74ocs1kWC7KO1vGd8Py7Reasi4MyxF0OyOJeNDAwMOgSFOZmIBqsH6J7LfFPzoxYQ+Hf7hVhdC2KmplyjntoTfnrG9rBVwF7RgT6/RmqlK4W+uEF8rmI/Nm10aZHMyMKI1tMZn9au//uAJaHfjPWcmyd2kgzWBujGYJywaWtpYqIq2ymRozNwMDAgPaMycQ0vu+XwVqhAJr0ZrSmSX8DJLN89ymZs12XisDdJjTXzVExip7A+hHF+FEWJTGx2Hshrr3NIsfNiwbYRfiPDT2PJnEjrgccJn/bHNU46a08t3Ahin69oyjTgy3Hfl0Ub59QDKoFeAHVJS9hXgUDA4POYskEeRhJ44DDI8d7OXJf6oD1Lcde33LskSg68emR8z8nv4+jclOIWDJBFqbUdxGF0F8UlZUhr2RxGe5Fj9BcRqNIC8fR2rX3XAaK8HpiyYQV0TvAs6H7WwWMy+F2JHTck6HfHcJal9m+qLgQoojeM1UfDAwMOjO7rAJ4yHLsxpCQ7Z5BCdyT4xzj5JMNbwETaN23IYzGHAXnmjIEwxGhG4soi8aQVfEQcESWc57nu97VWb47Qz7Z8BzwRIa/HxG5b8+LdfZfGVeainwUcDEqi5gcSvtJ4BK5V8OBrSzHnoxylSVCjYxSRskYGBh05phMDOWCGSSf7hliGr/0Xe/bIq2Ee4Gf+a63KofiqM7DsCJiSYByj0XjJFUauUBBkbkkKVSBunFRKrdk+44NPYsW4L/iqvuW1vGtAcB+ea7VHZiD6tL3PctMNgD7ha7xhCgvo2QMDAy6XO2yAMUS28Z3vReKPMdy4BLf9ZZEhHXUrdU/yzzikQTLQMq8BICfQcn0DR23ABXPmUkB8aQc+A74U0RZpjGSUHBelGjCcux9gJ8AsyOW4zixtrKhmyiRiSFL5WAUq8wKjedVUUhGyRgYGHRaJdMiNN/DgZ+hMlN3ACzf9cb6rjdd4xwPoHJARgJf0Zou3CrbXxTEtIilsWUWa8ZCuYrCY03XIfNFkYSF91bpst2+653pu94IGdP7BdyPm1C13bZCxTzCFsiZ0fwY+fcxkfF3Ax5FBeVfABx+yEIbkEfJVKBcZmlCxFao7OGKkKtspRxrlIyBgUGnUjLRWMZbvus94bvek77rPeu73vvZCjNmYWStRgW6p6My4sPuqONRiZRhvBxhk/VjLQOLSKwnTHX2WetCagYmRe7DWHFdEcm2jxUwlxUyl0+A/xeylmLAabROIEWUy9gCBX13sseL0tfqJuN4k7Uusx1Cc58oY+tuXgEDA4POzi4ry+/FSrmb1u6h7qhM/USEefVYRBFcZTn2TiELYX+xsOKR+I4fajLkisAlVAHgmoii6ZdBMejO5aaINdMPOCvCDtsV2LiIZzYug0IMo1ZK0EzMEENaALzeTmWFDAwMjJLpVFiOqicWFozHonJEwl3o/oRirRGqAvC25dhzLMf+BkX97R36fjZwRaTm2Csot1T4XpwBLLYc+yPLsT+T321SZHuEBcCtEWvmVJQ7LVxGJkxOeAHFCEtEPnvTmvCwPaoKQj48yQ9jSk9r9K4wMDAw6BTuMsr5e7EA7opYM92AC8LWjO96s0T5RN1yG/DDXtuLgGN811uQoWXqaaFdPSEa9laoOmzRnf7nIrh153ITrUv0W8B4UTA9+WE+0bO+6zX6rpcKf1A5M/MjuTBj81R0BpWY+Rqtk04ndtWS4QYGBj8+JRMvQunE8vx7Oap2WRhHo7Ldw0L8ZcCOCH0yFN/c1ne9D7IoAh8VSL+E1kU5o/gK+B0wxne9GQXMZb5YM+HvT0IREg6hdWJpM5GKySE0oHJnwuc5NpQzFM/0TMVlFs7L+Za1cZpM4zWVmQ0MDOiwzph9nO3iKYLtQzv8AJgmwhrNsjHDUZWAv99tV8cSMxdOeP/7+EZvx64NVDmYsND7OlsrUcux10e5kAbJmOYB7/qut1B3XL0duyZQpVg2EeupSZTEp77rzYwe3//4MbHmIDWStdRngG9815sdGVtPYIvIvZ6OijeF4z3NCWIf1LuTU1nmOIjW8ZsgBh/KQwjfq1QMPlzqeg3yuzpga7l+fWUs/sWiCR8E8t0wVFfN762+qlh8+nfyvYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgUEb4v8DJ1Ih95yNs+oAAAAASUVORK5CYII=" alt="The Fred Otto DiscoverE Program" />
</p>
<p style="font-size: 24px;"><b>Master Inventory Database</b></p>
<form id="queryForm">
  <label for="query">Enter Item Name: </label>
  <input type="text" id="query" name="query" onkeydown="searchInputKeyPressHandle(event);">
  <input type="button" value="Search" onclick="loadCacheAndSearch(false)">
  <input type="text" id="bluenote" value="&nbsp; NOTE: All blue shaded cells are editable and will modify the Inventory spreadsheet" style="font-weight: bold; background-color: #d0d0ff; border: none; margin-left: 150px; width: 535px;" readonly>
</form>
<br>
<!-- Set up the container for the add item feature -->
<div id="add_item_container"></div>
<br><br>
<!-- Set up the container for the table which holds the search results -->
<div id="results"></div>


<script>
// Global dev variables
const monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
const permissionsTypes = ["None", "Add", "Add & Delete", "Hidden", "Visible", "Edit"];
const addItemsIgnoreColumns = [0, 2]; // Tell the addItemsContainer which columns to ignore for the user input boxes ["Index", "Date"]. The user does not need to input values for these columns when adding an item to the inventory. This is in reference to the inventoryColTitles array
// Note: if you modify the columns in the permissions and inventory database sheets you may need to update this

// These variables store information collected from functions in the .gs file
var cachedInventoryData = null;         // Inventory in google sheets saved as cache to the website to reduce load time
var outputTable = [];                   // This is the output table when the user querries the search
var tableToOutputColumnTranslation = [] // This helps record which table columns are visible from the outputTable
var activeUser = null;                  // The email of the user currently viewing the website
var permissionsList = [];               // List of permissions the current user has

// These arrays keep track of the cells position and information corresponding to the inventory sheet
var inventoryColTitles = [];    // The name of the columns in the inventory aka the items attributes. Name, Location, Amount, etc...

var waitForDataIntervalID;  // ID for the inverval that runs the "waitForData" function

var preventTimedCacheReload = false; // Prevents the cache from reloading from the timed event. This is useful for when a user is modifying a cell they dont want it reload.


// Force the enter keypress act the same as the "Search" button in the input box
function searchInputKeyPressHandle(event) {
  if (event.key === "Enter") {
    event.preventDefault();     // Prevent the enter key from running its main functionality
    loadCacheAndSearch(false);
  }
}

// Load the cache from the inventory sheet and run the search query of the current user inputted search term
// Note that loading the cache takes longer than running the search so the order in which these occur is technically swapped
function loadCacheAndSearch(requery=true) {
  loadInventoryToCache(requery);   // Runs first but loads second
  searchInventory();               // Runs second but loads first (and then runs and loads third in the loadInventoryToCache function if the requery is set to true)
  // To be clear, this is the order (ignore the last RUN and LOAD if requery is set to false):
  // RUN loadInventoryToCache() -> RUN searchInventory() -> searchInventory() LOADS -> loadInventoryToCache LOADS -> RUN searchInventory() -> searchInventory() LOADS
  // The searchInventory() loads first so the user does not have to wait for any cache updates. It is then run again when the cache is updated in the event there is a 
  // discrepancy in the new cache vs the current output
}

// Load the inventory from google sheets into a cache variable as a 2d array
function loadInventoryToCache(requery=true, reloadFromTime=false) {
  // Prevent loading from timed interval if it is requested
  if (reloadFromTime && preventTimedCacheReload)
    return;
  preventTimedCacheReload = false;  // Reset this if the check passed meaning that it was not from a timed interval
  
  // Load the cache
  let cacheUpdated = false;
  google.script.run.withSuccessHandler(data => {cachedInventoryData = data; cacheUpdated = true;}).getCachedInventoryDataGSFunction();
            
  // Wait for the cache to finish loading then requery the search
  function waitForCache() {
    if (cacheUpdated) {
      console.log("========    Cache Updated    " + getCurrentDateAndTime() + "    ========")
      if (requery)
        searchInventory();
      
      cacheUpdated = false;
      clearInterval(waitForCacheIntervalID); // Stop the active check
    }
  }
  waitForCacheIntervalID = setInterval(waitForCache, 100);  // Start the active check
}


// Loads all required elements and data for the website onload
function initialize() {
  // Get the active user and store its value in the global "activeUser" variable
  google.script.run.withSuccessHandler(user => {activeUser = user}).getActiveUserGSFunction();
  // Get the permissions list from the sheet and store it in the the global "permissionsList" array
  google.script.run.withSuccessHandler(list => {permissionsList = list}).getPermissionsListGSFunction();
  // Get the entire inventory from the sheet and store it in the "cachedInventoryData" 2d array as cached data
  loadInventoryToCache(false);
  // Then set an interval to continually update this cached inventory data after some time has passed
  setInterval(() => {loadInventoryToCache(true, true)}, 60000);  // 60 second interval = 60,000 miliseconds
  // (I could not find a better way to get the variables from the .gs file so this is what I resorted to)


  // Wait for all the data to be received from the gs functions before allowing the user to use the search feature
  // So far this takes around 3 seconds on average
  waitForDataIntervalID = setInterval(waitForData, 100);
  // Hide the search html form while waiting for data and temporarily set the search result element to a loading indicator
  document.getElementById("queryForm").style.visibility = "hidden";
  document.getElementById("results").innerHTML = "<b>Loading Inventory Dataset...</b>";
}

// Wait for all the data to be received from the gs functions before allowing the user to use the search feature
// So far this takes around 3 seconds on average
function waitForData() {
  if (cachedInventoryData === null || activeUser === null || permissionsList.length === 0) return;
  if (!checkPermissions()) {
    alert("There is an error with the Permissions sheet");
    clearInterval(waitForDataIntervalID); // Stop the active check
    document.getElementById("results").innerHTML = "Could not load data";
    return;
  }

  // If everything is cleared then allow the user to start searching the inventory
  clearInterval(waitForDataIntervalID); // Stop the active check
  document.getElementById("queryForm").style.visibility = "visible";
  document.getElementById("results").innerHTML = "";
  // Set the column titles as an array by getting the first index of the permissionsList 2d array
  for (let i = 2; i < permissionsList[0].length; i++)
    inventoryColTitles.push(permissionsList[0][i]);
  // If the active user matches the permissions list name 
  // or the end of the list is reached, which is reserved for "Other User" permissions,
  // set the permissions to a 1d array containing only that users permissions
  for (let i = 1; i < permissionsList.length; i++) {
    if (activeUser === permissionsList[i][0] || i === permissionsList.length-1) {
      permissionsList = permissionsList[i];
      break;
    }
  }

  if (permissionsList[1] === permissionsTypes[1] || permissionsList[1] === permissionsTypes[2]) // Permissions === "Add" or "Add & Delete"
    setupAddItemsContainer();

  
  // Hide the blue note if the user does not have any editing power
  let atLeastOneEditPermissions = false;
  for (let i = 2; i < permissionsList.length; i++) {
    if (permissionsList[i] === permissionsTypes[5]) { // Permissions[i] === "Edit"
      atLeastOneEditPermissions = true;
      break;
    }
  }
  if (!atLeastOneEditPermissions)
    document.getElementById("bluenote").style.visibility = "hidden";
}

// Check if the permissions are set correctly and have no discrepancies
function checkPermissions() {
  // Check if there is at least one user
  if (permissionsList.length < 2)
    return false;
  // If there is only one user check, to make sure that only user is the "other" user
  let firstUser = permissionsList[1][0].toLowerCase();
  if (permissionsList.length === 2 && firstUser !== "other" && firstUser !== "other user" && firstUser !== "other users")
    return false;
  
  // Check if all the permissions were set correctly for each user
  for (let y = 1; y < permissionsList.length; y++) {
    for (let x = 1; x < permissionsList[y].length; x++) {
      // Search the current permissions cell value in the permissionsTypes array
      let i;
      for (i = 0; i < permissionsTypes.length; i++)
        if (permissionsList[y][x] === permissionsTypes[i])
          break;
      // If i is the length of the array then the value was not found
      if (i === permissionsTypes.length)
        return false;
    }
  }
  return true;
}

function setupAddItemsContainer() {
  let addItemContainer = document.getElementById("add_item_container");

  let j = 0;  // Index for the addItemsIgnoreColumns array
  for (let i = 0; i < inventoryColTitles.length; i++) {
    // Skip all the columns the user doesn't need to input items into the inventory
    if (j < addItemsIgnoreColumns.length && i === addItemsIgnoreColumns[j]) {
      j++;
      continue;
    }

    // Create a new input element for each iteration
    let input = document.createElement("input");
    input.type = "text";
    input.placeholder = inventoryColTitles[i];
    input.id = "addItemInput" + i;  // Match the column in the inventory database
    input.name = "addItemInput" + i;
    input.onkeydown = function(event) {
      if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault();
      }
    };
    addItemContainer.appendChild(input);
    
    // Add a non-breaking space between each input box
    let nbsp = document.createTextNode('\u00A0'); // Non-breaking space
    addItemContainer.appendChild(nbsp);
  }

  // Create the add button
  let button = document.createElement("button");
  button.id = "addItemButton";
  button.name = "addItemButton";
  button.textContent = "Add New Item";
  button.setAttribute("onclick", "addItem()"); 
  addItemContainer.appendChild(button);
}

function addItem() {
  let addItemContainer = document.getElementById("add_item_container");

  // Get all the inputted data
  let item = [];
  let requireFirst = true;  // Make sure the first input is set. This is the name of the item. This is required for the program to work minimually
  let j = 0;  // Index for the addItemsIgnoreColumns array
  for (let i = 0; i < inventoryColTitles.length; i++) {
    // Add empty columns that are not inputted. This helps keep this array correspond to the columns in the inventory dataset
    if (j < addItemsIgnoreColumns.length && i === addItemsIgnoreColumns[j]) {
      j++;
      item.push("");
      continue;
    }

    let inputValue = document.getElementById("addItemInput"+i).value;
    inputValue = inputValue.trim();
    if (requireFirst && inputValue === "") {
      alert("The name of the Item is required");
      return;
    }
    requireFirst = false; // Once the first input was added turn off the requirement
    item.push(inputValue);
  }

  // Hide the button while its loading
  document.getElementById("addItemButton").style.visibility = "hidden";

  google.script.run.withSuccessHandler(function(addStatus) {
    if (addStatus) {
      console.log(addStatus);
      alert("Failed to add the Item. Error: " + addStatus);
    } else {
      // Reset all the input boxes to blank fields
      for (let i = 0; i < inventoryColTitles.length; i++) {
        let inputBox = document.getElementById("addItemInput"+i);
        if (inputBox) {
          inputBox.value = "";
        }
      }
      // Add the new element to the cache
      item[0] = cachedInventoryData.length; // Set the new items index to the end of the data
      cachedInventoryData.push(item); // Add the new item to the beginning of the cached data
      // Set the index of the newly pushed item
      cachedInventoryData[cachedInventoryData.length-1][0] = cachedInventoryData.length;
      // Search the inventory with the new item so it shows on top
      document.getElementById("query").value = item[1];
      searchInventory();
    }

    // Show the button again after its done loading
    document.getElementById("addItemButton").style.visibility = "visible";
  }).addInventoryItem(item);
}


function searchInventory() {
  // -------------------
  // Query the Inventory
  // -------------------
  let searchQuery = document.getElementById("query").value;
  searchQuery = searchQuery.trim().toLowerCase();
  if (searchQuery === "") return;    // Skip if the query is empty
  // Search by broad or specific
  if (searchQuery[0] === '|') { // Search each term in the query to each term of each items name and searchTerm in the cached inventory
    searchQuery = searchQuery.split(' ');
  } else {                      // Search only the exact query to each term in the items name and searchTerm in the cached inventory
    searchQuery = [null, searchQuery];
  }
  // Error handle for improperly retrieved data
  if (cachedInventoryData.length === 0 || cachedInventoryData[0].length < inventoryColTitles.length) {
    alert("There was an issue retrieving the inventory data");
    return;
  } // Note: the short circuit nature of the || operation will NOT cause an error when attempting to retrieve the 0th index if the length is 0

  // Query the inventory data from cache and append each items row in a results array
  outputTable = [];
  let lastIndex = -1;   // Avoid duplicating results by remembering the previous output index
  for (let i = 0; i < cachedInventoryData.length; i++) {
    let row = cachedInventoryData[i];
    let index = row[0];
    let name = row[1].toString().toLowerCase();
    let searchTerms = row[3].toString().toLowerCase();
    // Add the row if the search query matches any sub strings in the name or the search terms
    for (let j = 1; j < searchQuery.length; j++) {
      if (index !== lastIndex && (name.includes(searchQuery[j]) || searchTerms.includes(searchQuery[j]) || searchQuery[j] === '*')) {
        outputTable.push(row);
        lastIndex = index;
      }
    }
  }

  // --------------------------------
  // Order the results using its date
  // --------------------------------
  outputTable.sort((a, b) => {
    const dateA = parseDate(a[2]);
    const dateB = parseDate(b[2]);
    return dateB - dateA; // Descending order
  });


  // -------------------
  // Display the Results
  // -------------------

  let resultsDiv = document.getElementById("results");
  if (outputTable.length === 0) {
    resultsDiv.innerHTML = "No items found.";
    return;
  }

  // Setup the table
  let html = '<table id="results_table" style="border-collapse: collapse; width: 100%;"><tr style="background-color: black; color: white;">';

  // Set the title row
  tableToOutputColumnTranslation = [];
  if (permissionsList[1] === permissionsTypes[2]) // Permissions === "Add & Delete"
    html += '<th>&emsp;</th>';  // Delete feature buttons column header
  for (let i = 0; i < inventoryColTitles.length; i++) {
    let j = i+2;  // Corresponding index for the permissionsList to the inventoryColTitles arrays
    if (permissionsList[j] === permissionsTypes[4] || permissionsList[j] === permissionsTypes[5]) { // Permissions === "Visible" or "Edit"
      html += '<th>' + inventoryColTitles[i] + '</th>';
      tableToOutputColumnTranslation.push(i);
    }
  }
  html += '</tr>';
  
  // Set each cell
  for (let y = 0; y < outputTable.length; y++) {
    html += '<tr>';

    // Add the delete buttons
    if (permissionsList[1] === permissionsTypes[2])     // Permissions === "Add & Delete"
      html += '<td><button class="delete_button" onclick=deleteItem('+y+')>Delete Item</button></td>';

    // Set each cell depending on its permission level
    // And also add an alternating colour style to the cells background
    for (let x = 0; x < outputTable[y].length; x++) {
      let i = x+2;  // Corresponding index for the permissionsList to the outputTable[y] row
      if (permissionsList[i] === permissionsTypes[4]) {               // Permissions === "Visible"
        if (y % 2 === 0)
          html += '<td>' + outputTable[y][x] + '</td>';
        else
          html += '<td style="background-color: #e0e0e0;">' + outputTable[y][x] + '</td>';
        
      } else if (permissionsList[i] === permissionsTypes[5]) {         // Permissions === "Edit"
        if (y % 2 === 0)
          html += '<td style="background-color: #e8e8ff;"';
        else
          html += '<td style="background-color: #d0d0ff;"';
        html += ' contenteditable="true" onblur="handleCellEdit(event)" onkeydown="cellEditKeyDownHandle(event)">' + outputTable[y][x] + '</td>';
      }
    }
    html += '</tr>';
  }
  html += '</table>';
  resultsDiv.innerHTML = html;
}



function deleteItem(tableRow) {
  let askResult = confirm("Are you sure you want to delete this row in the Master Inventory Database?");
  if (!askResult) return;  // User did not press OK

  // Hide all delete buttons while its loading
  let deleteButtons = document.getElementsByClassName("delete_button");
  for (let i = 0; i < deleteButtons.length; i++)
    deleteButtons[i].style.visibility = "hidden";

  // Translate the positions to correspond to the inventory sheet rows and columns
  const itemInventoryRow = outputTable[tableRow][0]+1;

  // Get the items name of the cell being modified from the cache
  // This will be checked in the inventory sheet to verify it is the correct item being modified
  const itemName = outputTable[tableRow][1];

  google.script.run.withSuccessHandler(function(deleteStatus) {
    if (deleteStatus) {
      console.log(deleteStatus);
      alert("Failed to delete the row. Error: " + deleteStatus);
      loadInventoryToCache();
    } else {
      // Remove the row from the cached data
      cachedInventoryData.splice(itemInventoryRow-2, 1);
      // Reset the indexes in the cached data
      for (let i = 0; i < cachedInventoryData.length; i++)
        cachedInventoryData[i][0] = i+1;
      // Requery the inventory which will show the removed row and also reset the delete buttons back
      searchInventory();
    }
  }).deleteInventoryRow(itemInventoryRow, itemName);
}

function cellEditKeyDownHandle(event) {
    preventTimedCacheReload = true;
    if (event.key === "Enter" && !event.shiftKey) {
        event.preventDefault(); // Prevent inserting a newline in the cell
        event.target.blur();    // Move focus away from the cell to trigger blur event
    }
}

function handleCellEdit(event) {
  preventTimedCacheReload = false;  // Allow the timed interval cache reload to continue as normal when the user is done editing the cell

  // Get the new cells value
  const cell = event.target;
  const row = cell.parentElement;
  let rowIndex = Array.from(row.parentElement.children).indexOf(row);
  let colIndex = Array.from(row.children).indexOf(cell);
  const cellValue = cell.innerText;

  // Account for an increase of columns if the user has permissions to delete rows
  if (permissionsList[1] === permissionsTypes[2]) // Permissions === "Add & Delete"
    colIndex -= 1;

  // Translate the positions to correspond to the inventory sheet rows and columns
  let itemInventoryRow = outputTable[rowIndex-1][0]+1;
  let itemInventoryCol = tableToOutputColumnTranslation[colIndex-1]+1+1;

  // Get the items name of the cell being modified from the cache
  // This will be checked in the inventory sheet to verify it is the correct item being modified
  const itemName = outputTable[rowIndex-1][1];

  // Update the inventory using the function in the .gs script
  google.script.run.withSuccessHandler(function(updateStatus) {
    // If there was an issue editing the cell then alert the user of the error
    if (updateStatus) {
      let errorMessage = "Failed to update the cell. Error: " + updateStatus;
      console.log(errorMessage);
      alert(errorMessage);
      loadInventoryToCache();
    }
  }).updateInventoryFromWebpage(itemInventoryRow, itemInventoryCol, cellValue, itemName);
}




function parseDate(dateString) {
    try {
      const splitDate = dateString.split(' ');
      const year = parseInt(splitDate[1].split(',')[0]);
      const monthName = splitDate[2];
      const day = parseInt(splitDate[3]);
      let month = 0;
      for (let i = 0; i < monthNames.length; i++) {
        if (monthName === monthNames[i]) {
          month = i+1;
          break;
        }
      }
      return ( year*12 + month ) * 32 + day;  // *12 and *32 to convert years months and days as different "digits" in their own numbering system 
    } catch (e) {
      return 0;
    }
  }

function getCurrentDateAndTime() {
  const now = new Date();
  const hours = now.getHours();
  const minutes = now.getMinutes();
  const seconds = now.getSeconds();

  // Format as a string and return
  return hours+":"+minutes+":"+seconds;
}

</script>
</body>
</html>
